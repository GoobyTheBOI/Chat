<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="main.css">
</head>

<body>
    <div class="chatrooms-background"></div>
    <nav class="menu">
        <button class="menu__button menu__button--margin-right menu__button--background-transparent menu__hide-button"
            onclick="return getBack();"><img src="./img/back-button.png" alt=""></button>
        <div class="w-100">
            <div class="menu__flex-colmn menu__flex-align-center">
                <h1 class="menu__title">Enter chatbox</h1>
                <p class="menu__nickname" id="nickname__chat"></p>
            </div>
        </div>
        <div class="menu__flex-end menu__hide">
            <a href="/rooms">
                <button
                    class="menu__button menu__button--active menu__button-background menu__button-background--rooms">ROOMS</button>
            </a>
            <a href="/users">
                <button
                    class="menu__button menu__button--blue menu__button-background menu__button-background--users">USERS</button>
            </a>
            <button onclick="return logout();"
                class="menu__button menu__button--blue menu__button-background menu__button-background--quit">QUIT</button>
        </div>
    
    </nav>
    <div class="container-users">
        <div class="userarea">
            <div class="userarea__users userarea__users--p-m-left">
                <ul id="users" class="userarea__user-list">
                </ul>
            </div>
        </div>

        <div class="users users--margin-top">
            <div class="users__chatroom">
                <p class="users__chatroom_title" id="user__id"></p>
            </div>
        </div>
    </div>
    <footer class="footer">
        <a href="/chatrooms">
            <img src="./img/message-square-lightgray.png" class="footer__img" alt="message">
        </a>
        <a href="/users">
            <img src="./img/users-blue.png" class="footer__img footer__img--users" alt="message">
        </a>
        <img src="./img/sign-out-alt-solid.png" class="footer__img footer__img--logout" alt="message">
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="/socket.io/socket.io.js"></script>
    <script src="main.bundle.js"></script>
    <script>
        let username = localStorage.getItem('userName');
        document.getElementById('nickname__chat').innerHTML = `#${username}`;

        const socket = io('/tech');

        socket.on('connect', () => {
            //event toevoegen voor iedereen
            socket.emit('join', { users: username });
        });

        socket.on("users", (data) => {
            $("#user__id").html(`${data.length}`);
            for (let i = 0; i < data.length; i++) {
                console.log(data)
                // if (data[i].user_name == username) {
                    $('#users').append($('<li class="userarea__user-list-name"></li>').html(`${data[i].user}`))
                // } 
                // else {
                //     $('#message').append($('<li class="chatarea__message messages--received messages--send-margin-top"></li>').html(`<p>${data[i].user_name}: <p class='messages__text'>${data[i].chat_text}</p> <p class='flex-end'>${getTime(date)}</p>`))
                // }
            }
        });

        logout = () => {
            localStorage.removeItem('userName');
            return window.location.href = "/";
        }
    </script>
</body>

</html>